<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Timer with Dropdown</title>
</head>
<body>
  <div id="counterDisplay">
    Individual: <span id="individualCount">0</span> | 
    Particular: <span id="particularCount">0</span> | 
    Universal: <span id="universalCount">0</span>
  </div>
  <div id="timerList"></div>
  <button id="addTimerBtn">Add Timer</button>
  <div id="contentDisplayContainer">
    <h2>Content Display</h2>
  </div>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const timerList = document.getElementById("timerList");
      const addTimerBtn = document.getElementById("addTimerBtn");
      const contentDisplayContainer = document.getElementById("contentDisplayContainer");

      const counters = {
        Individual: 0,
        Particular: 0,
        Universal: 0
      };

      function updateCounterDisplay() {
        document.getElementById("individualCount").innerText = counters.Individual;
        document.getElementById("particularCount").innerText = counters.Particular;
        document.getElementById("universalCount").innerText = counters.Universal;
      }

      addTimerBtn.addEventListener("click", addTimer);

      function createTimerComponent() {
        const timerComponent = document.createElement("div");
        timerComponent.className = "timer";
        timerComponent.innerHTML = `
          <input type="text" placeholder="Timer Title" class="timer-title"/>
          <input type="text" value="2:00" class="timer-value"/>
          <div class="flex-row">
            <button class="start-pause-btn">▶️</button>
            <button class="reset-initial-btn">⏏️</button>
            <button class="reset-default-btn">⤵️</button>
            <button class="remove-btn">❌</button>
            <button class="form-btn">Form</button>
            <button class="content-btn">Content</button>
          </div>
        `;
        timerList.appendChild(timerComponent);

        const contentBtn = timerComponent.querySelector(".content-btn");
        const dropdownMenu = document.createElement("div");
        dropdownMenu.classList.add("dropdown-menu");
        dropdownMenu.innerHTML = `
          <button class="dropdown-item" data-type="Individual">Individual</button>
          <button class="dropdown-item" data-type="Particular">Particular</button>
          <button class="dropdown-item" data-type="Universal">Universal</button>
        `;
        timerComponent.appendChild(dropdownMenu);

        let assignedCategories = new Set();

        contentBtn.addEventListener("click", () => {
          dropdownMenu.classList.toggle("show-dropdown");
        });

        dropdownMenu.addEventListener("click", (e) => {
          const selectedContent = e.target.dataset.type;
          openContentForm(selectedContent, timerComponent, assignedCategories);
        });

        return timerComponent;
      }

      function openContentForm(contentType, timerComponent, assignedCategories) {
        const existingForm = document.getElementById("contentForm");
        if (existingForm) {
          existingForm.remove();
        }

        const formHTML = `
          <div id="contentForm">
            <input type="text" id="topicName" placeholder="Enter Topic Name"/>
            <input type="text" id="topicTime" value="2:00" placeholder="Enter Time (e.g., 2 min)"/>
            <button id="submitContentBtn">Submit</button>
          </div>
        `;

        const contentForm = document.createElement("div");
        contentForm.innerHTML = formHTML;
        document.body.appendChild(contentForm);

        const submitContentBtn = contentForm.querySelector("#submitContentBtn");
        submitContentBtn.addEventListener("click", () => {
          const topicName = document.getElementById("topicName").value;
          const topicTime = document.getElementById("topicTime").value;

          if (topicName && topicTime) {
            addContentSection(contentType, topicName, topicTime);
            assignedCategories.add(contentType);
            counters[contentType]++;
            updateCounterDisplay();
            contentForm.remove();
          }
        });
      }

      function addContentSection(type, title, time) {
        const contentSection = document.createElement("div");
        contentSection.className = "content-section";
        
        let timerRunning = false;
        let timerInterval;
        let currentTime = time; // Save the original time for later use

        contentSection.innerHTML = `
          <strong>${type}:</strong> ${title} - Time: <span class="time-display" contenteditable="true">${time}</span>
          <button class="remove-content-btn">❌</button>
          <button class="play-pause-btn">▶️</button>
        `;
        
        contentDisplayContainer.appendChild(contentSection);

        const removeContentBtn = contentSection.querySelector(".remove-content-btn");
        removeContentBtn.addEventListener("click", () => {
          contentSection.remove();
          counters[type]--;
          updateCounterDisplay();
        });

        const playPauseBtn = contentSection.querySelector(".play-pause-btn");
        const timeDisplay = contentSection.querySelector(".time-display");

        playPauseBtn.addEventListener("click", () => {
          if (timerRunning) {
            clearInterval(timerInterval);
            playPauseBtn.innerText = "▶️";
          } else {
            // When starting, get the time from the contenteditable element
            let editedTime = timeDisplay.innerText;
            let [minutes, seconds] = editedTime.split(":").map(Number);

            timerInterval = setInterval(() => {
              if (seconds > 0) {
                seconds--;
              } else if (minutes > 0) {
                minutes--;
                seconds = 59;
              } else {
                clearInterval(timerInterval);
              }
              editedTime = `${minutes}:${seconds < 10 ? "0" + seconds : seconds}`;
              timeDisplay.innerText = editedTime;
            }, 1000);
            playPauseBtn.innerText = "⏸️";
          }
          timerRunning = !timerRunning;
        });
      }

      function addTimer() {
        createTimerComponent();
      }
    });
  </script>
</body>
</html>
